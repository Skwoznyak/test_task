{% extends 'base.html' %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-8">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2><i class="fas fa-tasks"></i> –ú–æ–∏ –∑–∞–¥–∞—á–∏</h2>
            <button class="btn btn-primary" onclick="showCreateTaskModal()">
                <i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
            </button>
        </div>

        <!-- –§–∏–ª—å—Ç—Ä—ã -->
        <div class="row mb-3">
            <div class="col-md-3">
                <select class="form-select" id="status-filter" onchange="filterTasks()">
                    <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                    <option value="pending">–í –æ–∂–∏–¥–∞–Ω–∏–∏</option>
                    <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                    <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–∞</option>
                    <option value="cancelled">–û—Ç–º–µ–Ω–µ–Ω–∞</option>
                </select>
            </div>
            <div class="col-md-3">
                <select class="form-select" id="priority-filter" onchange="filterTasks()">
                    <option value="">–í—Å–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã</option>
                    <option value="low">–ù–∏–∑–∫–∏–π</option>
                    <option value="medium">–°—Ä–µ–¥–Ω–∏–π</option>
                    <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                </select>
            </div>
            <div class="col-md-3">
                <button class="btn btn-outline-secondary" onclick="showOverdueTasks()">
                    <i class="fas fa-exclamation-triangle"></i> –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ
                </button>
            </div>
            <div class="col-md-3">
                <button class="btn btn-outline-primary" onclick="refreshTasks()">
                    <i class="fas fa-sync"></i> –û–±–Ω–æ–≤–∏—Ç—å
                </button>
            </div>
        </div>

        <!-- –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á -->
        <div id="tasks-container">
            <div class="text-center">
                <div class="spinner-border" role="status">
                    <span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-chart-pie"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h5>
            </div>
            <div class="card-body">
                <div id="stats-container">
                    <div class="text-center">
                        <div class="spinner-border spinner-border-sm" role="status">
                            <span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card mt-3">
            <div class="card-header">
                <h5><i class="fas fa-list"></i> –°–ø–∏—Å–∫–∏ –∑–∞–¥–∞—á</h5>
            </div>
            <div class="card-body">
                <div id="task-lists-container">
                    <div class="text-center">
                        <div class="spinner-border spinner-border-sm" role="status">
                            <span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏ -->
<div class="modal fade" id="createTaskModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="create-task-form">
                    <div class="mb-3">
                        <label for="task-title" class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ *</label>
                        <input type="text" class="form-control" id="task-title" required>
                    </div>
                    <div class="mb-3">
                        <label for="task-description" class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea class="form-control" id="task-description" rows="3"></textarea>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="task-list" class="form-label">–°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á *</label>
                                <select class="form-select" id="task-list" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–∏—Å–æ–∫</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="assigned-to" class="form-label">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å *</label>
                                <select class="form-select" id="assigned-to" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="task-priority" class="form-label">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                                <select class="form-select" id="task-priority">
                                    <option value="medium">–°—Ä–µ–¥–Ω–∏–π</option>
                                    <option value="low">–ù–∏–∑–∫–∏–π</option>
                                    <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="due-date" class="form-label">–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</label>
                                <input type="datetime-local" class="form-control" id="due-date">
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                <button type="button" class="btn btn-primary" onclick="createTask()">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á–∏ -->
<div class="modal fade" id="editTaskModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="edit-task-form">
                    <input type="hidden" id="edit-task-id">
                    <div class="mb-3">
                        <label for="edit-task-title" class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ *</label>
                        <input type="text" class="form-control" id="edit-task-title" required>
                    </div>
                    <div class="mb-3">
                        <label for="edit-task-description" class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea class="form-control" id="edit-task-description" rows="3"></textarea>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="edit-assigned-to" class="form-label">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å *</label>
                                <select class="form-select" id="edit-assigned-to" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="edit-task-status" class="form-label">–°—Ç–∞—Ç—É—Å</label>
                                <select class="form-select" id="edit-task-status">
                                    <option value="pending">–í –æ–∂–∏–¥–∞–Ω–∏–∏</option>
                                    <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                                    <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–∞</option>
                                    <option value="cancelled">–û—Ç–º–µ–Ω–µ–Ω–∞</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="edit-task-priority" class="form-label">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                                <select class="form-select" id="edit-task-priority">
                                    <option value="low">–ù–∏–∑–∫–∏–π</option>
                                    <option value="medium">–°—Ä–µ–¥–Ω–∏–π</option>
                                    <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="edit-due-date" class="form-label">–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</label>
                                <input type="datetime-local" class="form-control" id="edit-due-date">
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                <button type="button" class="btn btn-primary" onclick="updateTask()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>
</div>

<script>
let tasks = [];
let taskLists = [];
let users = [];

// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
document.addEventListener('DOMContentLoaded', function() {
    loadTasks();
    loadTaskLists();
    loadUsers();
    loadStats();
});

function loadTasks() {
    fetch('/api/tasks/my_tasks/')
        .then(response => response.json())
        .then(data => {
            tasks = data;
            renderTasks(data);
        })
        .catch(error => {
            console.error('Error loading tasks:', error);
            showToast('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞—á', 'danger');
        });
}

function loadTaskLists() {
    fetch('/api/task-lists/')
        .then(response => response.json())
        .then(data => {
            taskLists = data;
            renderTaskLists(data);
        })
        .catch(error => {
            console.error('Error loading task lists:', error);
        });
}

function loadUsers() {
    fetch('/api/users/')
        .then(response => response.json())
        .then(data => {
            users = data;
        })
        .catch(error => {
            console.error('Error loading users:', error);
        });
}

function loadStats() {
    fetch('/api/tasks/my_tasks/')
        .then(response => response.json())
        .then(data => {
            const stats = calculateStats(data);
            renderStats(stats);
        })
        .catch(error => {
            console.error('Error loading stats:', error);
        });
}

function calculateStats(tasks) {
    const total = tasks.length;
    const completed = tasks.filter(t => t.status === 'completed').length;
    const inProgress = tasks.filter(t => t.status === 'in_progress').length;
    const pending = tasks.filter(t => t.status === 'pending').length;
    const overdue = tasks.filter(t => t.is_overdue).length;
    
    return { total, completed, inProgress, pending, overdue };
}

function renderStats(stats) {
    const container = document.getElementById('stats-container');
    container.innerHTML = `
        <div class="row text-center">
            <div class="col-6">
                <div class="h4 text-primary">${stats.total}</div>
                <div class="small text-muted">–í—Å–µ–≥–æ</div>
            </div>
            <div class="col-6">
                <div class="h4 text-success">${stats.completed}</div>
                <div class="small text-muted">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
            </div>
        </div>
        <hr>
        <div class="row text-center">
            <div class="col-4">
                <div class="h5 text-warning">${stats.inProgress}</div>
                <div class="small text-muted">–í —Ä–∞–±–æ—Ç–µ</div>
            </div>
            <div class="col-4">
                <div class="h5 text-info">${stats.pending}</div>
                <div class="small text-muted">–û–∂–∏–¥–∞–Ω–∏–µ</div>
            </div>
            <div class="col-4">
                <div class="h5 text-danger">${stats.overdue}</div>
                <div class="small text-muted">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ</div>
            </div>
        </div>
    `;
}

function renderTaskLists(lists) {
    const container = document.getElementById('task-lists-container');
    if (lists.length === 0) {
        container.innerHTML = '<p class="text-muted">–ù–µ—Ç —Å–ø–∏—Å–∫–æ–≤ –∑–∞–¥–∞—á</p>';
        return;
    }
    
    let html = '';
    lists.forEach(list => {
        html += `
            <div class="d-flex justify-content-between align-items-center mb-2">
                <div>
                    <strong>${list.name}</strong>
                    <br><small class="text-muted">${list.task_count} –∑–∞–¥–∞—á</small>
                </div>
                <button class="btn btn-sm btn-outline-primary" onclick="createTaskInList(${list.id})">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
        `;
    });
    container.innerHTML = html;
}

function renderTasks(tasksToRender) {
    const container = document.getElementById('tasks-container');
    
    if (tasksToRender.length === 0) {
        container.innerHTML = '<div class="text-center text-muted"><i class="fas fa-inbox fa-3x mb-3"></i><p>–ù–µ—Ç –∑–∞–¥–∞—á</p></div>';
        return;
    }
    
    let html = '';
    tasksToRender.forEach(task => {
        const statusClass = `status-${task.status}`;
        const priorityClass = `priority-${task.priority}`;
        const isOverdue = task.is_overdue;
        
        const statusIcons = {
            'pending': '‚è≥',
            'in_progress': 'üîÑ',
            'completed': '‚úÖ',
            'cancelled': '‚ùå'
        };
        
        const priorityIcons = {
            'low': 'üü¢',
            'medium': 'üü°',
            'high': 'üî¥'
        };
        
        const dueDate = task.due_date ? new Date(task.due_date).toLocaleString() : '–ù–µ —É–∫–∞–∑–∞–Ω';
        
        html += `
            <div class="card task-card mb-3 ${statusClass} ${priorityClass} ${isOverdue ? 'border-danger' : ''}">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start">
                        <div class="flex-grow-1">
                            <h5 class="card-title">
                                ${statusIcons[task.status]} ${priorityIcons[task.priority]} ${task.title}
                                ${isOverdue ? '<span class="badge bg-danger ms-2">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ</span>' : ''}
                            </h5>
                            <p class="card-text">${task.description || '–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è'}</p>
                            <div class="row">
                                <div class="col-md-6">
                                    <small class="text-muted">
                                        <i class="fas fa-user"></i> –°–æ–∑–¥–∞—Ç–µ–ª—å: ${task.created_by.username}<br>
                                        <i class="fas fa-calendar"></i> –°—Ä–æ–∫: ${dueDate}
                                    </small>
                                </div>
                                <div class="col-md-6">
                                    <small class="text-muted">
                                        <i class="fas fa-list"></i> –°–ø–∏—Å–æ–∫: ${task.task_list.name}<br>
                                        <i class="fas fa-clock"></i> –°–æ–∑–¥–∞–Ω–∞: ${new Date(task.created_at).toLocaleString()}
                                    </small>
                                </div>
                            </div>
                        </div>
                        <div class="btn-group-vertical">
                            <button class="btn btn-sm btn-outline-primary" onclick="editTask(${task.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            ${task.status !== 'completed' ? `
                                <button class="btn btn-sm btn-outline-success" onclick="markTaskCompleted(${task.id})">
                                    <i class="fas fa-check"></i>
                                </button>
                            ` : ''}
                        </div>
                    </div>
                </div>
            </div>
        `;
    });
    
    container.innerHTML = html;
}

function filterTasks() {
    const statusFilter = document.getElementById('status-filter').value;
    const priorityFilter = document.getElementById('priority-filter').value;
    
    let filteredTasks = tasks;
    
    if (statusFilter) {
        filteredTasks = filteredTasks.filter(task => task.status === statusFilter);
    }
    
    if (priorityFilter) {
        filteredTasks = filteredTasks.filter(task => task.priority === priorityFilter);
    }
    
    renderTasks(filteredTasks);
}

function showOverdueTasks() {
    const overdueTasks = tasks.filter(task => task.is_overdue);
    renderTasks(overdueTasks);
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–∏–ª—å—Ç—Ä—ã
    document.getElementById('status-filter').value = '';
    document.getElementById('priority-filter').value = '';
}

function refreshTasks() {
    loadTasks();
    loadStats();
    showToast('–ó–∞–¥–∞—á–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã', 'success');
}

function showCreateTaskModal() {
    // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–∫–∏
    const taskListSelect = document.getElementById('task-list');
    taskListSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–∏—Å–æ–∫</option>';
    taskLists.forEach(list => {
        taskListSelect.innerHTML += `<option value="${list.id}">${list.name}</option>`;
    });
    
    const assignedToSelect = document.getElementById('assigned-to');
    assignedToSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</option>';
    users.forEach(user => {
        assignedToSelect.innerHTML += `<option value="${user.id}">${user.username}</option>`;
    });
    
    const modal = new bootstrap.Modal(document.getElementById('createTaskModal'));
    modal.show();
}

function createTask() {
    const formData = {
        title: document.getElementById('task-title').value,
        description: document.getElementById('task-description').value,
        task_list: document.getElementById('task-list').value,
        assigned_to: document.getElementById('assigned-to').value,
        priority: document.getElementById('task-priority').value,
        due_date: document.getElementById('due-date').value
    };
    
    if (!formData.title || !formData.task_list || !formData.assigned_to) {
        showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'warning');
        return;
    }
    
    fetch('/api/tasks/', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        },
        body: JSON.stringify(formData)
    })
    .then(response => response.json())
    .then(data => {
        if (data.id) {
            showToast('–ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞', 'success');
            bootstrap.Modal.getInstance(document.getElementById('createTaskModal')).hide();
            document.getElementById('create-task-form').reset();
            loadTasks();
            loadStats();
        } else {
            showToast('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏', 'danger');
        }
    })
    .catch(error => {
        console.error('Error creating task:', error);
        showToast('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏', 'danger');
    });
}

function editTask(taskId) {
    const task = tasks.find(t => t.id === taskId);
    if (!task) return;
    
    document.getElementById('edit-task-id').value = task.id;
    document.getElementById('edit-task-title').value = task.title;
    document.getElementById('edit-task-description').value = task.description;
    document.getElementById('edit-task-status').value = task.status;
    document.getElementById('edit-task-priority').value = task.priority;
    document.getElementById('edit-due-date').value = task.due_date ? new Date(task.due_date).toISOString().slice(0, 16) : '';
    
    // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π
    const assignedToSelect = document.getElementById('edit-assigned-to');
    assignedToSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</option>';
    users.forEach(user => {
        const selected = user.id === task.assigned_to.id ? 'selected' : '';
        assignedToSelect.innerHTML += `<option value="${user.id}" ${selected}>${user.username}</option>`;
    });
    
    const modal = new bootstrap.Modal(document.getElementById('editTaskModal'));
    modal.show();
}

function updateTask() {
    const taskId = document.getElementById('edit-task-id').value;
    const formData = {
        title: document.getElementById('edit-task-title').value,
        description: document.getElementById('edit-task-description').value,
        assigned_to: document.getElementById('edit-assigned-to').value,
        status: document.getElementById('edit-task-status').value,
        priority: document.getElementById('edit-task-priority').value,
        due_date: document.getElementById('edit-due-date').value
    };
    
    if (!formData.title || !formData.assigned_to) {
        showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'warning');
        return;
    }
    
    fetch(`/api/tasks/${taskId}/`, {
        method: 'PATCH',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        },
        body: JSON.stringify(formData)
    })
    .then(response => response.json())
    .then(data => {
        if (data.id) {
            showToast('–ó–∞–¥–∞—á–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞', 'success');
            bootstrap.Modal.getInstance(document.getElementById('editTaskModal')).hide();
            loadTasks();
            loadStats();
        } else {
            showToast('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏', 'danger');
        }
    })
    .catch(error => {
        console.error('Error updating task:', error);
        showToast('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏', 'danger');
    });
}

function markTaskCompleted(taskId) {
    fetch(`/api/tasks/${taskId}/mark_completed/`, {
        method: 'POST',
        headers: {
            'X-CSRFToken': getCookie('csrftoken')
        }
    })
    .then(response => response.json())
    .then(data => {
        showToast('–ó–∞–¥–∞—á–∞ –æ—Ç–º–µ—á–µ–Ω–∞ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è', 'success');
        loadTasks();
        loadStats();
    })
    .catch(error => {
        console.error('Error marking task completed:', error);
        showToast('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏', 'danger');
    });
}

function createTaskInList(listId) {
    showCreateTaskModal();
    document.getElementById('task-list').value = listId;
}
</script>
{% endblock %}
